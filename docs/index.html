<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ntsportal - Functions for building and managing the NTSPortal database • ntsportal</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Inter-0.4.10/font.css" rel="stylesheet">
<link href="deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="ntsportal - Functions for building and managing the NTSPortal database">
<meta name="description" content="This package provides functionality for building and managing the NTSPortal database.">
<meta property="og:description" content="This package provides functionality for building and managing the NTSPortal database.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ntsportal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">25.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Front end UI</h6></li>
    <li><a class="dropdown-item" href="articles/using-ntsportal-front-end.html">Using ntsportal.bafg.de</a></li>
    <li><a class="dropdown-item" href="articles/Kurzanleitung-zur-ersten-Nutzung.html">Kurzanleitung zur ersten Nutzung</a></li>
    <li><a class="dropdown-item" href="articles/Dashboard-development.html">Dashboard development</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Using the Search API</h6></li>
    <li><a class="dropdown-item" href="articles/Searching-with-ElasticSearch-Query-DSL.html">Searching with Query DSL</a></li>
    <li><a class="dropdown-item" href="articles/Aggregations-with-ElasticSearch-Query-DSL.html">Aggregations with Query DSL</a></li>
    <li><a class="dropdown-item" href="articles/Connecting-to-NTSPortal-API.html">Using the Search API in R</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Database structure and algorithms</h6></li>
    <li><a class="dropdown-item" href="articles/Structure-of-NTSPortal.html">Structure of NTSPortal</a></li>
    <li><a class="dropdown-item" href="articles/Library-screening.html">Library Screening</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Database management</h6></li>
    <li><a class="dropdown-item" href="articles/Add-measurement-file-to-msrawfiles.html">Adding measurement files to msrawfiles</a></li>
    <li><a class="dropdown-item" href="articles/Modify-documents-using-API.html">Modifying documents via the API</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Naming conventions</h6></li>
    <li><a class="dropdown-item" href="articles/Station-naming.html">Station naming</a></li>
    <li><a class="dropdown-item" href="articles/Measurement-file-naming-conventions.html">Measurement file naming</a></li>
    <li><a class="dropdown-item" href="articles/Chromatographic-methods.html">Chromatographic methods naming</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://www.bafg.de" aria-label="BfG Website"><img class="bfg_logo" border="0" src="bfg_logo.png" height="50px" width="98px"></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bafg-bund/ntsportal" aria-label="View source code on github.com"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="ntsportal">ntsportal<a class="anchor" aria-label="anchor" href="#ntsportal"></a>
</h1></div>
<p>The goal of the R-package <em>ntsportal</em> is to provide the backend for the NTSPortal database and online dashboard for non-target-screening (based on LC/GC-HRMS measurements) of surface waters. NTSPortal is designed to process measurement files and make the processed data available via an API and through online dashboards. The dashboards allow searching, data analysis and visualisation. For detailed statistical analysis, the API can be used for accessing the data in Python or R scripts. The system currently uses <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html" class="external-link">Elasticsearch</a> as the DBMS. This R-package is used for processing data and building the database. The functions for data processing use <a href="https://github.com/bafg-bund/ntsworkflow" class="external-link">ntsworkflow</a>. For further information on the structure and internal design of ntsportal please refer to the documentation.</p>
<p>For German government agencies, access to the internally managed NTSPortal database is available. Please contact the Federal Institute of Hydrology at <a href="mailto:ntsportal@bafg.de" class="email">ntsportal@bafg.de</a>. This repository includes the back-end code for publication purposes but does not include the environmental data.</p>
<div class="section level2">
<h2 id="project-funding">Project Funding<a class="anchor" aria-label="anchor" href="#project-funding"></a>
</h2>
<p>The project was initiated by a research funding grant by the Federal Environment Agency (UBA, “Online Portal: Non-Target-Screening für die Umweltüberwachung der Zukunft” REFOPLAN 3720222010) and continued funding is provided by the research grant REFOPLAN 3723222020 (“Weiterentwicklung des Online Portals für die Umweltbeobactung der Zukunft”). Additional funding is provided by the Federal Ministry of Transport (BMV) and the Federal Ministry of the Environment (BMU).</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>Copyright 2025 Bundesanstalt für Gewässerkunde (Federal Institute of Hydrology)</p>
<p>ntsportal is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p>ntsportal is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with ntsportal. If not, see <a href="https://www.gnu.org/licenses/" class="external-link uri">https://www.gnu.org/licenses/</a>.</p>
<p>If you use the package or any derivative thereof, please cite the work, see <code>citation("ntsportal")</code>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>NTSPortal is a conglomerate of many systems (see Structure of NTSPortal). This guide describes the installation of the R-package ntsportal (the back-end processing and management tool).</p>
<div class="section level3">
<h3 id="installation-via-github">Installation via Github<a class="anchor" aria-label="anchor" href="#installation-via-github"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Create a Github PAT</li>
<li>Add it, with the following line, to <code>~/.Rprofile</code>
</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>GITHUB_PAT <span class="op">=</span> <span class="st">"&lt;...&gt;"</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Restart R session 4a) Confirm that Python and a virtual environment is available</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/virtualenv-tools.html" class="external-link">virtualenv_exists</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>If there are errors, check that <code>reticulate</code> is installed and the virtual environment is activated (in RStudio under Project or Global options). If no virtual environment is available, use <code><a href="https://rstudio.github.io/reticulate/reference/virtualenv-tools.html" class="external-link">reticulate::virtualenv_create()</a></code>.</p>
<ol start="4" style="list-style-type: decimal">
<li>Install ntsportal</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/remotes/man/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"bafg-bund/ntsportal"</span><span class="op">)</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Install Python packages</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/virtualenv-tools.html" class="external-link">virtualenv_install</a></span><span class="op">(</span>requirements <span class="op">=</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fs/man/path_package.html" class="external-link">path_package</a></span><span class="op">(</span><span class="st">"ntsportal"</span>, <span class="st">"pythonElasticComm"</span>, <span class="st">"requirements.txt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If not already created, this command will create the “r-reticulate” Python virtual environment and install packages.</p>
<ol start="6" style="list-style-type: decimal">
<li>Setup connection to Elasticsearch</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bafg-bund/ntsportal" class="external-link">ntsportal</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>ntsportal.elasticsearchHostUrl <span class="op">=</span> <span class="st">"https://my.elastic.cluster"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/connectNtsportal.html">connectNtsportal</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># first time: enter username and password</span></span>
<span><span class="fu"><a href="reference/ping.html">ping</a></span><span class="op">(</span><span class="fu"><a href="reference/getDbComm.html">getDbComm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/bafg-bund/ntsportal/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GNU <a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a>.0</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ntsportal</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Kevin S. Jewell <br><small class="roles"> Maintainer </small>   </li>
<li>Ole Lessmann <br><small class="roles"> Author </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Developed by Kevin S. Jewell, Ole Lessmann, Jonas Skottnik, Franziska Prodöhl, Nina Hermes, Arne Wick. <a href="https://www.bafg.de/EN/Service/Imprint/imprint_node.html">Imprint</a>.</p>
</div>

    </footer>
</div>





  </body>
</html>
